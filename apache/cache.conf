<VirtualHost 127.0.0.1:80>
	CacheDetailHeader On
	CacheEnable disk /
	CacheHeader On
	CacheIgnoreHeaders Set-Cookie
	CacheIgnoreNoLastMod On # Use CacheDefaultExpire (defaults to one hour)
	CacheLock On
	CacheStoreExpired On

	# https://httpd.apache.org/docs/2.4/mod/mod_dir.html#fallbackresource
	# This is the contemporary way to hand requests off to PHP/WP/whatever
	DirectoryIndex index.php
	FallbackResource /index.php

	# Disable PHP for uploads and deny any request for a PHP file.
	<Directory ~ /wp-content/uploads/>
		php_admin_flag engine 0
		FallbackResource disabled
		<Files *.php>
			Deny from all
		</Files>
	</Directory>

	# Vary on the cart hash and the session's customer ID
	Header merge Vary X-Woocommerce-Cart-Hash,X-Woocommerce-Session-Customer

 	# Vary on the protocol, as we use this header to punk is_ssl in wordpress.
	Header merge Vary X-Forwarded-Proto

	# If a max-age is set, propagate it into s-maxage for surrogate proxies
  # unless s-maxage is already set.
	SetEnvIf Cache-Control max-age=([[:digit:]]+) S_MAXAGE=$1
  SetEnvIf Cache-Control s-maxage=([[:digit:]]+) S_MAXAGE=$1
	Header merge Cache-Control s-maxage=%{S_MAXAGE}e env=S_MAXAGE

	# If must-revalidate is set, propagate it into proxy-revalidate for proxies
  # unless it's already set.
	SetEnvIf Cache-Control must-revalidate MUST_REVALIDATE=$0
	Header merge Cache-Control proxy-revalidate env=MUST_REVALIDATE

	# For any file on disk, assume a distant expiry date.
  # The cache requires an Expires/Cache-Control header for files when requested
  # with a query string (like WordPress does for versioned CSS/JS files).
  ExpiresActive On
  ExpiresDefault "modifcation plus 1 year"

</VirtualHost>
